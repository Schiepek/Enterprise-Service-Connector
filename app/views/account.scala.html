@(accounts: List[models.APIConfig],
        mailForm: Form[models.APIConfig],
        settings: models.Settings,
        settingsForm: Form[models.Settings])
@import models.ServiceProvider.GMAIL
@import models.ServiceProvider.SALESFORCE


@import helper._

@main("ESC") {

    <h1>Settings</h1>
    @form(action = routes.AccountController.setSettings(), args = 'class -> "aui") {
        <div class="field-group">
            <label for="serverUrl">Server URL</label>
            <input class="text" type="text" id="serverUrl" name="serverUrl" value="@settings.getServerUrl">
        </div>
        <div class="buttons-container">
            <div class="buttons">
                <input class="button submit" type="submit" value="Save">
            </div>
        </div>
    }

    <h1>Accounts</h1>

    @form(routes.AccountController.save(SALESFORCE.toString()), args = 'class -> "aui", 'name -> (SALESFORCE+"form"), 'id -> (SALESFORCE+"form")) {
    }
    @form(routes.AccountController.save(GMAIL.toString), args = 'class -> "aui", 'name -> (GMAIL+"form"), 'id -> (GMAIL+"form")) {
    }

    <table class="aui table-mini">
        <thead>
            <tr>
                <th>Provider</th>
                <th style="min-width: 500px;">Client Id</th>
                <th>Client Secret</th>
                <th>Status</th>
                <th style="min-width: 125px;" ">Aktionen</th>
            </tr>
        </thead>
        <tbody>
        @for(account <- accounts) {
            <tr>
                <td>@account.getProvider</td>
                <td class="textCell@account.getProvider">@account.getClientId</td>
                <td class="textCell@account.getProvider">@account.getClientSecret</td>

                <td class="editCell@account.getProvider editCell" style="display: none">
                    <input class="text text-long" type="text" id="clientId@account.getProvider" name="clientId" form="@account.getProvider()form" value="@account.getClientId">
                </td>
                <td class="editCell@account.getProvider editCell" style="display: none">
                    <input class="text text-middle" type="text" id="clientSecret@account.getProvider" name="clientSecret" form="@account.getProvider()form" value="@account.getClientSecret">
                </td>

                <td id="status_@account.getProvider"></td>
                <td>
                    <a href="javascript:document.@account.getProvider()form.submit()" id="save_@account.getProvider" class="save-btn" style="display: none"><button class="aui-button btn-mini"><span title="Save" class="aui-icon aui-icon-small aui-iconfont-approve"></span></button></a>
                    <a href="#" id="edit_@account.getProvider"><button class="aui-button btn-mini"><span title="Edit" class="aui-icon aui-icon-small aui-iconfont-edit"></span></button></a>
                    <a href="/accounts/authorize/@account.getProvider"><button class="aui-button btn-mini"><span title="Authorize" class="aui-icon aui-icon-small aui-iconfont-unlocked"></span></button></a>
                    <a href="#" onclick="$('#status_@account.getProvider').load('/accounts/check/@account.getProvider')"><button class="aui-button btn-mini"><span title="Check Status" class="aui-icon aui-icon-small aui-iconfont-build"></span></button></a>
                </td>
            </tr>
        }
        </tbody>
    </table>


    @form(routes.AccountController.transferContacts(), args = 'class -> "aui") {
        <div class="buttons">
            <input class="button submit" type="submit" value="Transfer Contacts">
        </div>
    }

    <script>
        jQuery(document ).ready(function() {

            jQuery("a[id^='edit']").click(function() {
                var provider = $(this).attr('id' ).replace('edit_', '');
                jQuery('#save_'+provider ).show();
                $(this).hide();
                jQuery('.editCell'+provider).show();
                jQuery('.textCell'+provider).hide();
            });

            jQuery("a[id^='save']").click(function() {
                var provider = $(this).attr('id' ).replace('save_', '');
                jQuery('#edit_'+provider ).show();
                $(this).hide();
                jQuery('.editCell'+provider).hide();
                jQuery('.textCell'+provider).show();
            });
        });

    </script>

}